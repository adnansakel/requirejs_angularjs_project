define([
		/* RequireJS modules definition files (w/o .js) */
		'app/app.module',
		'app/common/jsUtils/designPatterns',
		'app/components/network-modeling/network.services'
], function (app) {
	'use strict';


	app.register.controller('NetworkCtrl', 
			/* needed services */ ['$state', '$scope', 'IPLayerDisplay', 'SecurityLayerDisplay', 'EventAggregator',
			function ($state, $scope, IPLayerDisplay, SecurityLayerDisplay, EventAggregator) {

				// ======================================================================
				// UI-Router check page reload 
				// ======================================================================
				/*
				var params = angular.copy($state.params);
				params.reloadId = params.reloadId === null ? "" : null;
				$state.transitionTo($state.current, params, { reload: false, inherit: true, notify: true });
				*/
				
				// ======================================================================
				// Controller Variables 
				// ======================================================================

				// ======================================================================
				// Dummy Data
				// ======================================================================
				$scope.dummyNetworkData = [[{"data":{"id":1,"label":"IP Infrastructure","type":"IPNetworkLayer"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":1,"id":2,"label":"DAI-Subnet/servernet","type":"Subnet"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"id":3,"label":"3620-Cisco Router Firewall","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"id":4,"label":"Switch","type":"Switch"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"id":5,"label":"AP1200-2","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"id":6,"label":"HP Color LaserJet CP6015","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"id":7,"label":"Cisco 2811 WLC","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"id":8,"label":"Apache HTTP Server","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"id":9,"label":"Cisco 2821 Router Firewall","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"id":10,"label":"Switch1","type":"Switch"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"id":11,"label":"DAFIS-ST2540-ControllerA","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"id":12,"label":"MySQL Server","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"id":13,"label":"DAIGATE_Router","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"id":14,"label":"Switch2","type":"Switch"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"id":15,"label":"MFC-9460CDN","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"id":16,"label":"Sun StorageTek SL500","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"id":17,"label":"UCS-MGMT-Start","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"id":18,"label":"AP1200-1","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":1,"id":19,"label":"TargetSubnet","type":"Subnet"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":19,"id":20,"label":"Switch","type":"Switch"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":19,"id":21,"label":"Cisco 2811 Router","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":19,"id":22,"label":"MP3500-2","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":19,"id":23,"label":"Cisco UCS B230 M1 Server","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":19,"id":24,"label":"Switch4","type":"Switch"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":19,"id":26,"label":"MP3500-1","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":19,"id":27,"label":"MP3500-3","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":1,"id":28,"label":"ExternSubnet","type":"Subnet"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":28,"id":29,"label":"Switch","type":"Switch"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":28,"id":30,"label":"3620-Cisco Router 2","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":28,"id":31,"label":"Attacker PC-001","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":28,"id":32,"label":"PC-XI2","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":28,"id":33,"label":"Switch3","type":"Switch"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":28,"id":34,"label":"PC-XI1","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":28,"id":35,"label":"MySQL Server 2","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":1,"id":36,"label":"Internet","type":"Subnet"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":36,"id":37,"label":"CoreRouter1","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":36,"id":38,"label":"DAIGATE_Router","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":36,"id":40,"label":"AccessRouter","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":36,"id":41,"label":"CoreRouter 2","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":36,"id":42,"label":"3620-Cisco Router 2","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":1,"sourceLabel":"10.0.2.1","targetLabel":"","id":43,"source":3,"target":4},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.2","targetLabel":"","id":44,"source":5,"target":4},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.3","targetLabel":"","id":45,"source":6,"target":4},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.4","targetLabel":"","id":46,"source":7,"target":4},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.5","targetLabel":"","id":47,"source":8,"target":4},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.6","targetLabel":"10.0.2.16","id":48,"source":3,"target":38},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.7","targetLabel":"10.0.2.17","id":49,"source":9,"target":38},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.8","targetLabel":"","id":50,"source":9,"target":10},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.9","targetLabel":"","id":51,"source":11,"target":10},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.10","targetLabel":"","id":52,"source":12,"target":10},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.11","targetLabel":"","id":53,"source":38,"target":14},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.12","targetLabel":"","id":54,"source":15,"target":14},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.13","targetLabel":"","id":55,"source":16,"target":14},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.14","targetLabel":"","id":56,"source":17,"target":14},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.15","targetLabel":"","id":57,"source":18,"target":14},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"120.110.211.1","targetLabel":"","id":58,"source":39,"target":20},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"120.110.211.2","targetLabel":"","id":59,"source":22,"target":20},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"120.110.211.3","targetLabel":"","id":60,"source":23,"target":20},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"120.110.211.4","targetLabel":"","id":61,"source":40,"target":24},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"120.110.211.5","targetLabel":"","id":62,"source":26,"target":24},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"120.110.211.6","targetLabel":"","id":63,"source":27,"target":24},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"101.98.112.1","targetLabel":"","id":64,"source":42,"target":29},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"101.98.112.2","targetLabel":"","id":65,"source":31,"target":29},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"101.98.112.3","targetLabel":"","id":66,"source":32,"target":29},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"101.98.112.4","targetLabel":"","id":67,"source":42,"target":33},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"101.98.112.5","targetLabel":"","id":68,"source":34,"target":33},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"101.98.112.6","targetLabel":"","id":69,"source":35,"target":33},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"111.111.111.121","targetLabel":"111.111.111.120","id":70,"source":42,"target":41},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"111.111.111.117","targetLabel":"111.111.111.112","id":71,"source":38,"target":37},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"111.111.111.119","targetLabel":"111.111.111.113","id":72,"source":39,"target":37},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"111.111.111.118","targetLabel":"111.111.111.114","id":73,"source":40,"target":37},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"111.111.111.116","targetLabel":"111.111.111.115","id":74,"source":41,"target":37},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"120.110.211.20","targetLabel":"120.110.211.21","id":75,"source":39,"target":40},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"}],[{"data":{"id":76,"label":"Installed Products","type":"SecurityLayer"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":76,"id":77,"label":"AP1200-1","type":"Appliance"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":77,"id":78,"label":"cpe:2.3:o:microsoft:windows_7:*:sp1:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":77,"id":79,"label":"cpe:2.3:a:microsoft:word:2010:sp1:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":77,"id":80,"label":"cpe:2.3:a:microsoft:excel:2010:sp1:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":77,"id":81,"label":"cpe:2.3:a:microsoft:internet_explorer:10:*:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":77,"id":82,"label":"cpe:2.3:o:microsoft:windows_xp:*:sp3:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":77,"id":83,"label":"cpe:2.3:a:siemens:simatic_wincc:7.0:*:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":76,"id":84,"label":"AP1200-2","type":"Appliance"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":84,"id":85,"label":"cpe:2.3:o:microsoft:windows_7:*:sp1:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":84,"id":86,"label":"cpe:2.3:a:microsoft:word:2010:sp1:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":84,"id":87,"label":"cpe:2.3:a:microsoft:excel:2010:sp1:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":84,"id":88,"label":"cpe:2.3:a:microsoft:internet_explorer:10:*:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":84,"id":89,"label":"cpe:2.3:o:microsoft:windows_xp:*:sp3:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":84,"id":90,"label":"cpe:2.3:a:siemens:simatic_wincc:7.0:*:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":76,"id":91,"label":"DAFIS-ST2540-ControllerA","type":"Appliance"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":91,"id":92,"label":"cpe:2.3:o:microsoft:windows_7:*:sp1:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":91,"id":93,"label":"cpe:2.3:a:microsoft:word:2010:sp1:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":91,"id":94,"label":"cpe:2.3:a:microsoft:excel:2010:sp1:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":91,"id":95,"label":"cpe:2.3:a:microsoft:internet_explorer:10:*:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":91,"id":96,"label":"cpe:2.3:a:adobe:acrobat:8.1.1:*:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":76,"id":97,"label":"MySQL Server","type":"Appliance"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":97,"id":98,"label":"cpe:2.3:a:mysql:mysql:5.5.5:*:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":76,"id":99,"label":"Apache HTTP Server","type":"Appliance"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":99,"id":100,"label":"cpe:2.3:o:microsoft:windows_7:*:sp1:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":99,"id":101,"label":"cpe:2.3:a:apache:http_server:2.2.4:*:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":99,"id":102,"label":"cpe:2.3:a:adobe:acrobat:8.1.1:*:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":76,"id":103,"label":"Attacker PC-001","type":"Appliance"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":103,"id":104,"label":"cpe:2.3:o:microsoft:windows_7:*:sp1:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":103,"id":105,"label":"cpe:2.3:a:microsoft:internet_explorer:10:*:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":76,"id":106,"label":"3620-Cisco Router Firewall","type":"Appliance"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":106,"id":107,"label":"cpe:2.3:o:cisco:cisco_ios:12.2:*:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":76,"id":108,"label":"Cisco 2821 Router Firewall","type":"Appliance"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":108,"id":109,"label":"cpe:2.3:o:cisco:cisco_ios:12.2:*:*:*:*:*:*:*","type":"Installation"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":76,"id":110,"source":99,"target":97},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"}]];

				
				// ======================================================================
				// Some Utility Functions
				// ======================================================================
				
				// ======================================================================
				// 
				// ======================================================================
				
				//Definition of cytoscape var
				var cyIPlayer;		
	            
				$scope.testNetwork = [{"data":{"id":1,"label":"IP Infrastructure","type":"IPNetworkLayer"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":1,"id":2,"label":"DAI-Subnet/servernet","type":"Subnet"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"networkinterfaces":[{"address":"10.0.2.1"},{"address":"10.0.2.6"}],"id":3,"label":"3620-Cisco Router Firewall","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"id":4,"label":"Switch","type":"Switch"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"networkinterfaces":[{"address":"10.0.2.2"}],"id":5,"label":"AP1200-2","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"networkinterfaces":[{"address":"10.0.2.3"}],"id":6,"label":"HP Color LaserJet CP6015","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"networkinterfaces":[{"address":"10.0.2.4"}],"id":7,"label":"Cisco 2811 WLC","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"networkinterfaces":[{"address":"10.0.2.5"}],"id":8,"label":"Apache HTTP Server","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"networkinterfaces":[{"address":"10.0.2.7"},{"address":"10.0.2.8"}],"id":9,"label":"Cisco 2821 Router Firewall","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"id":10,"label":"Switch1","type":"Switch"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"networkinterfaces":[{"address":"10.0.2.9"}],"id":11,"label":"DAFIS-ST2540-ControllerA","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"networkinterfaces":[{"address":"10.0.2.10"}],"id":12,"label":"MySQL Server","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"networkinterfaces":[{"address":"10.0.2.16"},{"address":"10.0.2.17"},{"address":"10.0.2.11"},{"address":"111.111.111.117"}],"id":13,"label":"DAIGATE_Router","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"id":14,"label":"Switch2","type":"Switch"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"networkinterfaces":[{"address":"10.0.2.12"}],"id":15,"label":"MFC-9460CDN","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"networkinterfaces":[{"address":"10.0.2.13"}],"id":16,"label":"Sun StorageTek SL500","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"networkinterfaces":[{"address":"10.0.2.14"}],"id":17,"label":"UCS-MGMT-Start","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":2,"networkinterfaces":[{"address":"10.0.2.15"}],"id":18,"label":"AP1200-1","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":1,"id":19,"label":"TargetSubnet","type":"Subnet"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":19,"id":20,"label":"Switch","type":"Switch"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":19,"networkinterfaces":[{"address":"120.110.211.2"}],"id":22,"label":"MP3500-2","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":19,"networkinterfaces":[{"address":"120.110.211.3"}],"id":23,"label":"Cisco UCS B230 M1 Server","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":19,"id":24,"label":"Switch4","type":"Switch"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":19,"networkinterfaces":[{"address":"120.110.211.5"}],"id":26,"label":"MP3500-1","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":19,"networkinterfaces":[{"address":"120.110.211.6"}],"id":27,"label":"MP3500-3","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":1,"id":28,"label":"ExternSubnet","type":"Subnet"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":28,"id":29,"label":"Switch","type":"Switch"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":28,"networkinterfaces":[{"address":"101.98.112.2"}],"id":31,"label":"Attacker PC-001","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":28,"networkinterfaces":[{"address":"101.98.112.3"}],"id":32,"label":"PC-XI2","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":28,"id":33,"label":"Switch3","type":"Switch"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":28,"networkinterfaces":[{"address":"101.98.112.5"}],"id":34,"label":"PC-XI1","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":28,"networkinterfaces":[{"address":"101.98.112.6"}],"id":35,"label":"MySQL Server 2","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":1,"id":36,"label":"Internet","type":"Subnet"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":36,"networkinterfaces":[{"address":"111.111.111.112"},{"address":"111.111.111.113"},{"address":"111.111.111.114"},{"address":"111.111.111.115"}],"id":37,"label":"CoreRouter1","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":36,"networkinterfaces":[{"address":"10.0.2.16"},{"address":"10.0.2.17"},{"address":"10.0.2.11"},{"address":"111.111.111.117"}],"id":38,"label":"DAIGATE_Router","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":36,"networkinterfaces":[{"address":"120.110.211.1"},{"address":"111.111.111.119"},{"address":"120.110.211.20"}],"id":39,"label":"Cisco 2811 Router","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":36,"networkinterfaces":[{"address":"120.110.211.4"},{"address":"111.111.111.118"},{"address":"120.110.211.21"}],"id":40,"label":"AccessRouter","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":36,"networkinterfaces":[{"address":"111.111.111.120"},{"address":"111.111.111.116"}],"id":41,"label":"CoreRouter 2","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":36,"networkinterfaces":[{"address":"101.98.112.1"},{"address":"101.98.112.4"},{"address":"111.111.111.121"}],"id":42,"label":"3620-Cisco Router 2","type":"Device"},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"nodes"},{"data":{"parent":1,"sourceLabel":"10.0.2.1","targetLabel":"","id":43,"source":3,"target":4},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.2","targetLabel":"","id":44,"source":5,"target":4},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.3","targetLabel":"","id":45,"source":6,"target":4},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.4","targetLabel":"","id":46,"source":7,"target":4},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.5","targetLabel":"","id":47,"source":8,"target":4},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.6","targetLabel":"10.0.2.16","id":48,"source":3,"target":38},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.7","targetLabel":"10.0.2.17","id":49,"source":9,"target":38},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.8","targetLabel":"","id":50,"source":9,"target":10},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.9","targetLabel":"","id":51,"source":11,"target":10},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.10","targetLabel":"","id":52,"source":12,"target":10},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.11","targetLabel":"","id":53,"source":38,"target":14},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.12","targetLabel":"","id":54,"source":15,"target":14},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.13","targetLabel":"","id":55,"source":16,"target":14},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.14","targetLabel":"","id":56,"source":17,"target":14},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"10.0.2.15","targetLabel":"","id":57,"source":18,"target":14},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"120.110.211.1","targetLabel":"","id":58,"source":39,"target":20},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"120.110.211.2","targetLabel":"","id":59,"source":22,"target":20},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"120.110.211.3","targetLabel":"","id":60,"source":23,"target":20},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"120.110.211.4","targetLabel":"","id":61,"source":40,"target":24},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"120.110.211.5","targetLabel":"","id":62,"source":26,"target":24},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"120.110.211.6","targetLabel":"","id":63,"source":27,"target":24},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"101.98.112.1","targetLabel":"","id":64,"source":42,"target":29},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"101.98.112.2","targetLabel":"","id":65,"source":31,"target":29},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"101.98.112.3","targetLabel":"","id":66,"source":32,"target":29},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"101.98.112.4","targetLabel":"","id":67,"source":42,"target":33},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"101.98.112.5","targetLabel":"","id":68,"source":34,"target":33},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"101.98.112.6","targetLabel":"","id":69,"source":35,"target":33},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"111.111.111.121","targetLabel":"111.111.111.120","id":70,"source":42,"target":41},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"111.111.111.117","targetLabel":"111.111.111.112","id":71,"source":38,"target":37},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"111.111.111.119","targetLabel":"111.111.111.113","id":72,"source":39,"target":37},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"111.111.111.118","targetLabel":"111.111.111.114","id":73,"source":40,"target":37},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"111.111.111.116","targetLabel":"111.111.111.115","id":74,"source":41,"target":37},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"},{"data":{"parent":1,"sourceLabel":"120.110.211.20","targetLabel":"120.110.211.21","id":75,"source":39,"target":40},"selectable":true,"grabbable":true,"locked":false,"selected":false,"group":"edges"}];
				IPLayerDisplay($scope.testNetwork, $scope).then(function(iplayercy){
					cyIPlayer = iplayercy;
				});		
				
				
			   // $scope.dataResults =  [{"Products":[{"CWECount":0,"CVECount":0,"Product":"cpe:2.3:a:siemens:simatic_wincc:7.0:*:*:*:*:*:*:*","Vulnerabilities":[]},{"CWECount":1,"CVECount":1,"Product":"cpe:2.3:a:microsoft:word:2010:sp1:*:*:*:*:*:*","Vulnerabilities":[{"CWE":"CWE-399","Description":"Microsoft Word 2003 SP3, 2007 SP2 and SP3, and 2010 SP1; Word Viewer; Office Compatibility Pack SP2 and SP3; and Office Web Apps 2010 SP1 allow remote attackers to execute arbitrary code or cause a denial of service (memory corruption) via crafted RTF data, aka \"Word RTF 'listoverridecount' Remote Code Execution Vulnerability.\"","Name":"CVE-2012-2539"}]},{"CWECount":2,"CVECount":3,"Product":"cpe:2.3:a:microsoft:internet_explorer:10:*:*:*:*:*:*:*","Vulnerabilities":[{"CWE":"CWE-94","Description":"Use-after-free vulnerability in Microsoft Internet Explorer 6 through 10 allows remote attackers to execute arbitrary code via a crafted web site that triggers access to a deleted object, aka \"InjectHTMLStream Use After Free Vulnerability.\"","Name":"CVE-2012-4781"},{"CWE":"CWE-399","Description":"Use-after-free vulnerability in Microsoft Internet Explorer 9 and 10 allows remote attackers to execute arbitrary code via a crafted web site that triggers access to a deleted object, aka \"CMarkup Use After Free Vulnerability.\"","Name":"CVE-2012-4782"},{"CWE":"CWE-399","Description":"Use-after-free vulnerability in Microsoft Internet Explorer 9 and 10 allows remote attackers to execute arbitrary code via a crafted web site that triggers access to an object that (1) was not properly initialized or (2) is deleted, aka \"Improper Ref Counting Use After Free Vulnerability.\"","Name":"CVE-2012-4787"}]},{"CWECount":1,"CVECount":1,"Product":"cpe:2.3:o:microsoft:windows_7:*:sp1:*:*:*:*:*:*","Vulnerabilities":[{"CWE":"CWE-200","Description":"Cross-domain vulnerability in Microsoft XML Core Services 3.0 through 6.0, as used in Microsoft Expression Web, Office, Internet Explorer, and other products, allows remote attackers to obtain sensitive information from another domain and corrupt the session state via HTTP request header fields, as demonstrated by the Transfer-Encoding field, aka \"MSXML Header Request Vulnerability.\"","Name":"CVE-2008-4033"}]},{"CWECount":3,"CVECount":4,"Product":"cpe:2.3:o:microsoft:windows_xp:*:sp3:*:*:*:*:*:*","Vulnerabilities":[{"CWE":"CWE-189","Description":"Microsoft XML Core Services (MSXML) 3.0 through 6.0 allows remote attackers to execute arbitrary code via the substringData method on a (1) TextNode or (2) XMLDOM object, which causes an integer overflow that leads to a buffer overflow.","Name":"CVE-2007-2223"},{"CWE":"CWE-189","Description":"Integer overflow in the Internet Printing Protocol (IPP) ISAPI extension in Microsoft Internet Information Services (IIS) 5.0 through 7.0 on Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2, and Server 2008 allows remote authenticated users to execute arbitrary code via an HTTP POST request that triggers an outbound IPP connection from a web server to a machine operated by the attacker, aka \"Integer Overflow in IPP Service Vulnerability.\"","Name":"CVE-2008-1446"},{"CWE":"CWE-20","Description":"The setRequestHeader method of the XMLHttpRequest object in Microsoft Internet Explorer 5.01, 6, and 7 does not block dangerous HTTP request headers when certain 8-bit character sequences are appended to a header name, which allows remote attackers to (1) conduct HTTP request splitting and HTTP request smuggling attacks via an incorrect Content-Length header, (2) access arbitrary virtual hosts via a modified Host header, (3) bypass referrer restrictions via an incorrect Referer header, and (4) bypass the same-origin policy and obtain sensitive information via a crafted request header.","Name":"CVE-2008-1544"},{"CWE":"CWE-119","Description":"Heap-based buffer overflow in the InternalOpenColorProfile function in mscms.dll in Microsoft Windows Image Color Management System (MSCMS) in the Image Color Management (ICM) component on Windows 2000 SP4, XP SP2 and SP3, and Server 2003 SP1 and SP2 allows remote attackers to execute arbitrary code via a crafted image file.","Name":"CVE-2008-2245"}]},{"CWECount":3,"CVECount":4,"Product":"cpe:2.3:a:microsoft:excel:2010:sp1:*:*:*:*:*:*","Vulnerabilities":[{"CWE":"CWE-119","Description":"Microsoft Excel 2003 SP3, 2007 SP2 and SP3, and 2010 Gold and SP1; Office 2011 for Mac; Excel Viewer; and Office Compatibility Pack SP2 and SP3 do not properly handle memory during the opening of files, which allows remote attackers to execute arbitrary code via a crafted spreadsheet, aka \"Excel File Format Memory Corruption Vulnerability.\"","Name":"CVE-2012-0141"},{"CWE":"CWE-399","Description":"Microsoft Excel 2003 SP3, 2007 SP2 and SP3, and 2010 Gold and SP1; Office 2008 for Mac; Excel Viewer; and Office Compatibility Pack SP2 and SP3 do not properly handle memory during the opening of files, which allows remote attackers to execute arbitrary code via a crafted spreadsheet, aka \"Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability.\"","Name":"CVE-2012-0142"},{"CWE":"CWE-264","Description":"Microsoft Excel 2003 SP3, 2007 SP2 and SP3, and 2010 Gold and SP1; Office 2008 and 2011 for Mac; Excel Viewer; and Office Compatibility Pack SP2 and SP3 do not properly handle memory during the opening of files, which allows remote attackers to execute arbitrary code via a crafted spreadsheet, aka \"Excel SXLI Record Memory Corruption Vulnerability.\"","Name":"CVE-2012-0184"},{"CWE":"CWE-264","Description":"Heap-based buffer overflow in Microsoft Excel 2007 SP2 and SP3 and 2010 Gold and SP1, Excel Viewer, and Office Compatibility Pack SP2 and SP3 allows remote attackers to execute arbitrary code via a crafted spreadsheet that triggers incorrect handling of memory during opening, aka \"Excel MergeCells Record Heap Overflow Vulnerability.\"","Name":"CVE-2012-0185"}]}],"IP":"10.0.2.15"}]; 	
			  //  $scope.IP = $scope.dataResults[0].IP;
			    
			  //  $scope.applications=[{"Ip":"120.110.211.3","Application":"Dummy App","Malware":"Dummy_Malware_1.exe"},{"Ip":"10.0.2.10","Application":"Dummy App 2","Malware":"DummyMalware2--1.html.jpg.image.dll"},{"Ip":"10.0.2.11","Application":"Dummy App 3","Malware":"Dummy::Malware-3::DOC.ExE"},{"Ip":"106.100.44.200","Application":"Dummy App 4","Malware":"Very_long_dummy_Malware_4.JPEG.EXE"},{"Ip":"106.100.44.201","Application":"Dummy App 5","Malware":"Dropbox.exe.Dummy_Malware_5.exe"},{"Ip":"120.110.211.2","Application":"Dummy App 6","Malware":"Dummy_Malware_6.exe"},{"Ip":"120.110.211.4","Application":"Dummy App 7","Malware":"Dummy_Malware_7.exe"}];
			    
			//	SecurityLayerDisplay.formProductTable($scope.dataResults[0].Products, $scope);
		     //   SecurityLayerDisplay.formVulnerabilityTable($scope.dataResults[0].Products, $scope);
		        
			}]); // -- END

});
